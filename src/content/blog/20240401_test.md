---
isDraft: false
title: markdown blog sample test. markdown blog sample test. markdown blog sample test. markdown blog sample test. markdown blog sample test. markdown blog sample test. markdown blog sample test. markdown blog sample test. markdown blog sample test. markdown blog sample test.
tags: ['test1', 'test2']
createdDate: 2023-11-15
modifiedDate: 2023-11-16
topic: 오늘하루정말 재밌는일들이 있었느냐? 오늘하루정말 재밌는일들이 있었느냐? 오늘하루정말 재밌는일들이 있었느냐? 오늘하루정말 재밌는일들이 있었느냐? 오늘하루정말 재밌는일들이 있었느냐? 오늘하루정말 재밌는일들이 있었느냐? 오늘하루정말 재밌는일들이 있었느냐? 오늘하루정말 재밌는일들이 있었느냐? 오늘하루정말 재밌는일들이 있었느냐? 오늘하루정말 재밌는일들이 있었느냐? 오늘하루정말 재밌는일들이 있었느냐? 오늘하루정말 재밌는일들이 있었느냐?
slug: '20240401'
---

![sample_image](https://i.pinimg.com/564x/1a/ef/6a/1aef6aaeba15e13c07608fa415995aec.jpg)

```dockerfile
FROM node:20.11.1-alpine AS base

FROM base AS deps
RUN apk update && apk add --no-cache libc6-compat
WORKDIR /usr/src/app

COPY package.json pnpm-lock.yaml* ./
RUN \
  if [ -f pnpm-lock.yaml ]; then corepack enable pnpm && pnpm i --frozen-lockfile; \
  else echo "Lockfile not found." && exit 1; \
  fi

FROM base AS builder
WORKDIR /usr/src/app
COPY . .
COPY --from=deps /usr/src/app/node_modules ./node_modules

RUN \
  if [ -f pnpm-lock.yaml ]; then corepack enable pnpm && pnpm run build; \
  else echo "Lockfile not found." && exit 1; \
  fi

FROM base AS runner
RUN corepack enable pnpm && pnpm add pm2
WORKDIR /usr/src/app

ENV NODE_ENV production

RUN addgroup --system --gid 1001 nodejs
RUN adduser --system --uid 1001 nextjs

RUN mkdir .next
RUN chown nextjs:nodejs .next

COPY --from=builder /usr/src/app/public ./public
COPY --from=builder --chown=nextjs:nodejs /usr/src/app/.next/standalone ./
COPY --from=builder --chown=nextjs:nodejs /usr/src/app/.next/static ./.next/static

USER nextjs

EXPOSE 5173

ENV PORT 5173
ENV HOSTNAME "0.0.0.0"

CMD ["pm2-runtime", "start", "server.js"]
```
